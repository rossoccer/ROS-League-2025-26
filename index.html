<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ROS Winter League 2025/26</title>
  <style>
    :root{
      --bg:#eef2f6; --card:#ffffff; --muted:#5b606b; --text:#0f172a;
      --brand:#2563eb; --brand-2:#7c3aed; --border:#e2e8f0;
      --radius-xl:20px; --shadow:0 8px 20px rgba(15,23,42,.06);
    }
    *{box-sizing:border-box}
    body{margin:0;font:15px/1.55 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;color:var(--text);
      background:url("ultrawide-blue-3840x2160-19825.png") center center / cover no-repeat fixed}

    /* Header / nav */
    header{position:sticky;top:0;z-index:9999;background:rgba(255,255,255,.92);backdrop-filter:saturate(180%) blur(10px);border-bottom:1px solid var(--border)}
    header::after{content:"";position:absolute;inset:auto 0 0 0;height:2px;background:linear-gradient(90deg,var(--brand),var(--brand-2));opacity:.6}
    .nav{max-width:1200px;margin:0 auto;display:flex;align-items:center;gap:12px;padding:10px 16px 12px;position:relative}
    .brand{display:flex;align-items:center;gap:10px;font-weight:800}
    .logo{width:28px;height:28px;border-radius:8px;display:grid;place-items:center;background:linear-gradient(135deg,var(--brand),var(--brand-2));color:#fff}

    /* Tabs (desktop) */
    .tabs{margin-left:auto;display:flex;gap:0;overflow:hidden;border-radius:14px;background:linear-gradient(180deg,#ffffffaa,#ffffffee);border:1px solid var(--border);box-shadow:0 4px 14px rgba(15,23,42,.06)}
    .tab{border:0;background:transparent;color:var(--text);padding:10px 22px;cursor:pointer;font-weight:800;letter-spacing:.2px;position:relative;transition:all .2s ease;white-space:nowrap;border-right:1px solid var(--border)}
    .tab:last-child{border-right:none}
    .tab:hover{background:#f5f7ff;color:var(--brand)}
    .tab[aria-current="page"]{background:linear-gradient(90deg,var(--brand),var(--brand-2));color:#fff;border-color:transparent;box-shadow:0 3px 10px rgba(37,99,235,.2)}

    /* Mobile nav: dropdown */
    .menuToggle{display:none;margin-left:auto;border:1px solid var(--border);background:#fff;border-radius:10px;padding:8px 10px;cursor:pointer;font-weight:800}
    .menuToggle:active{transform:scale(.98)}
    @media (max-width:720px){
      .nav{flex-wrap:nowrap}
      .menuToggle{display:inline-flex;align-items:center;gap:8px}
      .tabs{display:none;position:absolute;top:100%;left:16px;right:16px;width:auto;flex-direction:column;overflow:visible;border-radius:12px;background:#fff;z-index:10000}
      .tabs.open{display:flex}
      .tab{border-right:none;border-top:1px solid var(--border);text-align:left;padding:14px 16px}
      .tab:first-child{border-top:none}
      .tab[aria-current="page"]{background:linear-gradient(90deg,var(--brand),var(--brand-2));color:#fff}
    }

    /* Layout */
    main{max-width:1200px;margin:22px auto;padding:0 16px}

    /* Background wrapper JUST behind info boxes */
    .infoBg{
      background-image:url('SL-072321-44560-17.jpg');
      background-position:center; background-size:cover; background-repeat:no-repeat;
      border:1px solid var(--border); border-radius:24px; padding:16px; margin-bottom:16px;
    }

    /* Cards */
    .card{background:var(--card);border:1px solid var(--border);border-radius:var(--radius-xl);box-shadow:var(--shadow)}
    .card h2{margin:0;font-size:18px}
    .card .hd{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;border-bottom:1px solid var(--border)}
    .card .bd{padding:12px 16px}
    .badge{background:#eef2ff;color:#334155;padding:3px 8px;border-radius:999px;font-size:12px;border:1px solid #dbe3ff}
    .muted{color:var(--muted)}
    .pill{padding:4px 8px;border-radius:999px;background:#f2f7ff;border:1px solid #dbe3ff;color:#1f2a44;font-size:12px}

    /* HOME grid */
    .homeGrid{display:grid;gap:16px}
    @media (min-width:980px){
      .homeGrid{grid-template-columns:3fr 2fr; grid-template-rows:auto 1fr; align-items:stretch}
      .homeGrid > .card{height:100%}
      #homeRecent{grid-column:1;grid-row:1}
      #homeTable{ grid-column:1;grid-row:2}
      #homeScorers{grid-column:2;grid-row:1}
      #homeAssisters{grid-column:2;grid-row:2}
    }
    @media (max-width:979px){
      .homeGrid{grid-template-columns:1fr}
      .scoreBig{font-size:30px}
      .teamName{font-size:16px}
    }

    /* Fixtures / results rows */
    .matchRow{display:grid;grid-template-columns:1fr auto 1fr;gap:10px;align-items:center;padding:14px 16px;border:1px solid var(--border);border-radius:12px;background:#fff;margin-bottom:10px}
    .teamSide{display:flex;align-items:center;gap:10px}
    .teamName{font-weight:800;font-size:17px}
    .teamLogo{width:28px;height:28px;object-fit:contain;border-radius:6px}
    .scoreBig{font-size:38px;font-weight:900;text-align:center;min-width:120px}
    #homeRecent .bd{max-height:320px;overflow:auto}

    /* League Table */
    #homeTable .bd{height:100%;display:flex;flex-direction:column}
    #homeTable .tableWrap{flex:1;min-height:280px;overflow:auto}

    /* Leaders */
    .toplist{display:flex;flex-direction:column;gap:12px}
    .row{display:grid;grid-template-columns:46px 1fr auto;align-items:center;gap:12px}
    .avatar{width:42px;height:42px;border-radius:50%;background:linear-gradient(135deg,var(--brand),var(--brand-2));color:#fff;display:grid;place-items:center;font-weight:800}
    .statValue{font-weight:900;font-size:32px;line-height:1;color:var(--text)}
    .statUnit{font-size:12px;color:#475569;margin-left:6px}

    /* Tables */
    table{width:100%;border-collapse:collapse}
    th,td{padding:10px;border-bottom:1px solid var(--border);text-align:left}
    tbody tr:hover{background:#edf2ff}
    th button{background:none;border:none;color:var(--text);font-weight:600;cursor:pointer}

    /* Embeds */
    .iframeWrap{position:relative;width:100%;padding-top:60%;border:1px solid var(--border);border-radius:12px;overflow:hidden;background:#fff}
    .iframeWrap iframe{position:absolute;inset:0;width:100%;height:100%;border:0}

    /* Logos strip */
    .logoCard{margin-top:16px}
    .logoStrip{display:grid;grid-template-columns:repeat(5,1fr);gap:16px;align-items:center}
    .logoStrip img{width:100%;height:140px;object-fit:contain;display:block}
    @media (max-width:980px){.logoStrip{grid-template-columns:repeat(3,1fr)}}
    @media (max-width:560px){.logoStrip{grid-template-columns:repeat(2,1fr)}}
  </style>
</head>
<body>
<header>
  <div class="nav">
    <div class="brand">
      <div class="logo">❄️</div>
      <span>ROS Winter League 2025/26</span>
      <span class="badge" id="seasonRange">2025/26</span>
    </div>
    <button class="menuToggle" id="menuToggle" aria-expanded="false" aria-controls="siteTabs">☰ Menu</button>
    <nav class="tabs" id="siteTabs">
      <button class="tab" data-route="#home">Home</button>
      <button class="tab" data-route="#schedule">Schedule</button>
      <button class="tab" data-route="#rosters">Rosters</button>
      <button class="tab" data-route="#results">Results</button>
      <button class="tab" data-route="#stats">Full Stats</button>
    </nav>
  </div>
</header>

<main>
  <!-- HOME -->
  <section id="home" hidden>
    <div class="infoBg">
      <div class="homeGrid">
        <div class="card" id="homeRecent">
          <div class="hd"><h2>Latest Matchweek Scores</h2></div>
          <div class="bd" id="thisWeekResults"></div>
        </div>
        <div class="card" id="homeScorers">
          <div class="hd"><h2>Most Goals</h2><span class="badge" id="maxGoals">—</span></div>
          <div class="bd"><div class="toplist" id="topScorers"></div></div>
        </div>
        <div class="card" id="homeTable">
          <div class="hd">
            <h2>League Table</h2>
            <span class="badge" id="lastUpdated">—</span>
          </div>
          <div class="bd">
            <div class="muted" style="margin-bottom:6px">Tip: Click a column to sort.</div>
            <div class="tableWrap">
              <table id="table">
                <thead>
                  <tr>
                    <th>#</th>
                    <th><button data-sort="team">Team</button></th>
                    <th><button data-sort="played">P</button></th>
                    <th><button data-sort="wins">W</button></th>
                    <th><button data-sort="draws">D</button></th>
                    <th><button data-sort="losses">L</button></th>
                    <th><button data-sort="gf">GF</button></th>
                    <th><button data-sort="ga">GA</button></th>
                    <th><button data-sort="gd">GD</button></th>
                    <th><button data-sort="points">Pts</button></th>
                  </tr>
                </thead>
                <tbody></tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="card" id="homeAssisters">
          <div class="hd"><h2>Most Assists</h2><span class="badge" id="maxAssists">—</span></div>
          <div class="bd"><div class="toplist" id="topAssisters"></div></div>
        </div>
      </div>

      <!-- Team Logos strip -->
      <div class="card logoCard">
        <div class="hd"><h2>Teams</h2><span class="badge" id="logoSeason">2025/26</span></div>
        <div class="bd">
          <div class="logoStrip">
            <img src="Adda.png"    alt="Adda Athletic"        loading="lazy">
            <img src="Sagol.png"   alt="Sagol Er Dol"         loading="lazy">
            <img src="Crack.png"   alt="Crack Platoon"        loading="lazy">
            <img src="Gunners.png" alt="Gunners"              loading="lazy">
            <img src="Bhat.png"    alt="Goal Dile Bhat Free"  loading="lazy">
          </div>
        </div>
      </div>

    </div>
  </section>

  <!-- SCHEDULE PAGE -->
  <section id="schedule" hidden>
    <div class="infoBg">
      <div class="grid">
        <div class="card">
          <div class="hd"><h2>Schedule</h2><span class="badge" id="gameCount">—</span></div>
          <div class="bd" id="scheduleWrap"></div>
          <div class="bd"><div class="muted">All games at <strong>Bell Sensplex</strong>. Edit <code>data.schedule</code> to update.</div></div>
        </div>
      </div>
    </div>
  </section>

  <!-- ROSTERS -->
  <section id="rosters" hidden>
    <div class="infoBg">
      <div class="grid">
        <div class="card">
          <div class="hd"><h2>Team Rosters</h2><span class="badge" id="teamCount">—</span></div>
          <div class="bd" id="rosterList"></div>
        </div>
      </div>
    </div>
  </section>

  <!-- RESULTS -->
  <section id="results" hidden>
    <div class="infoBg">
      <div class="grid">
        <div class="card">
          <div class="hd"><h2>Match Results</h2><span class="badge" id="resultsCount">—</span></div>
          <div class="bd" id="resultsList"></div>
        </div>
      </div>
    </div>
  </section>

  <!-- FULL STATS (Sheets) -->
  <section id="stats" hidden>
    <div class="infoBg">
      <div class="grid">
        <div class="card">
          <div class="hd"><h2>Full Stats (Google Sheets)</h2><span class="badge">view-only</span></div>
          <div class="bd">
            <div class="iframeWrap" id="statsSheetWrap"></div>
            <div class="muted" style="margin-top:6px">Paste a public Sheets link into <code>data.embeds.statsSheetUrl</code>.</div>
          </div>
        </div>
      </div>
    </div>
  </section>
</main>

<script>
  // ========= DATA =========
  const data = {
    leagueName: "ROS Winter League 2025/26",
    seasonStart: "2025-10-29",
    seasonEnd:   "2026-02-19",
    embeds: { statsSheetUrl: "" },
    logoSrc: { T1:'Adda.png', T2:'Sagol.png', T3:'Crack.png', T4:'Gunners.png', T5:'Bhat.png' },
    teams: [
      { id:'T1', name:'Adda Athletic',       short:'ADD', color:'#111827' }, // black
      { id:'T2', name:'Sagol Er Dol',        short:'SED', color:'#ffffff' }, // white
      { id:'T3', name:'Crack Platoon',       short:'CPL', color:'#1d4ed8' }, // blue
      { id:'T4', name:'Gunners',             short:'GUN', color:'#ef4444' }, // red
      { id:'T5', name:'Goal Dile Bhat Free', short:'GDB', color:'#facc15' }  // yellow
    ],

    // All names capitalized; base stats = 0
    players: [
      // Gunners
      { id:'P401', teamId:'T4', name:'Shafiq', position:'C', goals:0, assists:0 },
      { id:'P402', teamId:'T4', name:'Neo', position:'GK', goals:0, assists:0 },
      { id:'P403', teamId:'T4', name:'Zee Chow', goals:0, assists:0 },
      { id:'P404', teamId:'T4', name:'Tazin', goals:0, assists:0 },
      { id:'P405', teamId:'T4', name:'Titu', goals:0, assists:0 },
      { id:'P406', teamId:'T4', name:'Ahnaf', goals:0, assists:0 },
      { id:'P407', teamId:'T4', name:'Ruhaan', goals:0, assists:0 },
      { id:'P408', teamId:'T4', name:'Tarek', goals:0, assists:0 },
      { id:'P409', teamId:'T4', name:'Tahsin', goals:0, assists:0 },
      { id:'P410', teamId:'T4', name:'Ahnaf', goals:0, assists:0 }, // second Ahnaf

      // Crack Platoon
      { id:'P301', teamId:'T3', name:'Arian', position:'C', goals:0, assists:0 },
      { id:'P302', teamId:'T3', name:'Alif', position:'GK', goals:0, assists:0 },
      { id:'P303', teamId:'T3', name:'Sowad', goals:0, assists:0 },            // fixed spelling
      { id:'P304', teamId:'T3', name:'Zareef', goals:0, assists:0 },
      { id:'P305', teamId:'T3', name:'Kaysh', goals:0, assists:0 },
      { id:'P306', teamId:'T3', name:'Sabir', goals:0, assists:0 },
      { id:'P307', teamId:'T3', name:'Ron', goals:0, assists:0 },
      { id:'P308', teamId:'T3', name:'Tahmid', goals:0, assists:0 },
      { id:'P309', teamId:'T3', name:'Sadman Sajid', goals:0, assists:0 },
      { id:'P310', teamId:'T3', name:'Ishraq', goals:0, assists:0 },

      // Sagol Er Dol
      { id:'P201', teamId:'T2', name:'Ilham', position:'C', goals:0, assists:0 },
      { id:'P202', teamId:'T2', name:'Dhiraj', position:'GK', goals:0, assists:0 },
      { id:'P203', teamId:'T2', name:'Saadman', goals:0, assists:0 },
      { id:'P204', teamId:'T2', name:'Sameen', goals:0, assists:0 },
      { id:'P205', teamId:'T2', name:'Habib', goals:0, assists:0 },
      { id:'P206', teamId:'T2', name:'Afnan', goals:0, assists:0 },
      { id:'P207', teamId:'T2', name:'Sindeed', goals:0, assists:0 },
      { id:'P208', teamId:'T2', name:'Zarif Jr', goals:0, assists:0 },
      { id:'P209', teamId:'T2', name:'Murshed', goals:0, assists:0 },
      { id:'P210', teamId:'T2', name:'Jabir', goals:0, assists:0 },

      // Goal Dile Bhat Free
      { id:'P501', teamId:'T5', name:'Tanzil', position:'C', goals:0, assists:0 },
      { id:'P502', teamId:'T5', name:'Osamah', position:'GK', goals:0, assists:0 },
      { id:'P503', teamId:'T5', name:'Abdu', goals:0, assists:0 },
      { id:'P504', teamId:'T5', name:'Arif', goals:0, assists:0 },
      { id:'P505', teamId:'T5', name:'Mim', goals:0, assists:0 },
      { id:'P506', teamId:'T5', name:'Prince', goals:0, assists:0 },
      { id:'P507', teamId:'T5', name:'Egal', goals:0, assists:0 },
      { id:'P508', teamId:'T5', name:'Abeed', goals:0, assists:0 },
      { id:'P509', teamId:'T5', name:'Fardin', goals:0, assists:0 },
      { id:'P510', teamId:'T5', name:'Shomi', goals:0, assists:0 },

      // Adda Athletic
      { id:'P101', teamId:'T1', name:'Tarun', position:'C', goals:0, assists:0 },
      { id:'P102', teamId:'T1', name:'Aymaan', position:'GK', goals:0, assists:0 },
      { id:'P103', teamId:'T1', name:'Adeeb', goals:0, assists:0 },
      { id:'P104', teamId:'T1', name:'Kabir', goals:0, assists:0 },
      { id:'P105', teamId:'T1', name:'Sadman Kabir', goals:0, assists:0 },
      { id:'P106', teamId:'T1', name:'Niaz', goals:0, assists:0 },
      { id:'P107', teamId:'T1', name:'Aymaan Alamgir', goals:0, assists:0 },  // fixed spelling
      { id:'P108', teamId:'T1', name:'Monjur', goals:0, assists:0 },
      { id:'P109', teamId:'T1', name:'Tabeeb', goals:0, assists:0 },
      { id:'P110', teamId:'T1', name:'Abid', goals:0, assists:0 }
    ],

    // Week 1 results entered
    matches: [
      { id:'R1G1', round:1, date:'2025-10-29', homeTeamId:'T3', awayTeamId:'T2', homeScore:3, awayScore:4, status:'final' }, // Crack 3–4 Sagol
      { id:'R1G2', round:1, date:'2025-10-29', homeTeamId:'T1', awayTeamId:'T5', homeScore:3, awayScore:2, status:'final' }  // Adda 3–2 GDB
    ],

    // Schedule (R1 final)
    schedule: [
      { id:'R1G1', round:1, date:'2025-10-29', time:'9:00 PM – 10:00 PM',  venue:'Bell Sensplex', home:'T3', away:'T2', status:'final' },
      { id:'R1G2', round:1, date:'2025-10-29', time:'10:00 PM – 11:00 PM', venue:'Bell Sensplex', home:'T1', away:'T5', status:'final' },

      { id:'R2G1', round:2, date:'2025-11-05', time:'9:00 PM – 10:00 PM',  venue:'Bell Sensplex', home:'T5', away:'T2', status:'scheduled' },
      { id:'R2G2', round:2, date:'2025-11-05', time:'10:00 PM – 11:00 PM', venue:'Bell Sensplex', home:'T4', away:'T3', status:'scheduled' },

      { id:'R3G1', round:3, date:'2025-11-12', time:'9:00 PM – 10:00 PM',  venue:'Bell Sensplex', home:'T1', away:'T2', status:'scheduled' },
      { id:'R3G2', round:3, date:'2025-11-12', time:'10:00 PM – 11:00 PM', venue:'Bell Sensplex', home:'T4', away:'T5', status:'scheduled' },

      { id:'R4G1', round:4, date:'2025-11-19', time:'9:00 PM – 10:00 PM',  venue:'Bell Sensplex', home:'T4', away:'T1', status:'scheduled' },
      { id:'R4G2', round:4, date:'2025-11-19', time:'10:00 PM – 11:00 PM', venue:'Bell Sensplex', home:'T3', away:'T5', status:'scheduled' },

      { id:'R5G1', round:5, date:'2025-11-26', time:'9:00 PM – 10:00 PM',  venue:'Bell Sensplex', home:'T4', away:'T2', status:'scheduled' },
      { id:'R5G2', round:5, date:'2025-11-26', time:'10:00 PM – 11:00 PM', venue:'Bell Sensplex', home:'T1', away:'T3', status:'scheduled' },

      { id:'R6G1', round:6, date:'2025-12-03', time:'9:00 PM – 10:00 PM',  venue:'Bell Sensplex', home:'T3', away:'T2', status:'scheduled' },
      { id:'R6G2', round:6, date:'2025-12-03', time:'10:00 PM – 11:00 PM', venue:'Bell Sensplex', home:'T1', away:'T5', status:'scheduled' },

      { id:'R7G1', round:7, date:'2025-12-10', time:'9:00 PM – 10:00 PM',  venue:'Bell Sensplex', home:'T5', away:'T2', status:'scheduled' },
      { id:'R7G2', round:7, date:'2025-12-10', time:'10:00 PM – 11:00 PM', venue:'Bell Sensplex', home:'T4', away:'T3', status:'scheduled' },

      { id:'R8G1', round:8, date:'2026-01-12', time:'10:00 PM – 11:00 PM', venue:'Bell Sensplex', home:'T1', away:'T2', status:'scheduled' },
      { id:'R8G2', round:8, date:'2026-01-12', time:'11:00 PM – 12:00 AM', venue:'Bell Sensplex', home:'T4', away:'T5', status:'scheduled' },

      { id:'R9G1', round:9, date:'2026-01-19', time:'10:00 PM – 11:00 PM', venue:'Bell Sensplex', home:'T4', away:'T1', status:'scheduled' },
      { id:'R9G2', round:9, date:'2026-01-19', time:'11:00 PM – 12:00 AM', venue:'Bell Sensplex', home:'T3', away:'T5', status:'scheduled' },

      { id:'R10G1', round:10, date:'2026-01-26', time:'10:00 PM – 11:00 PM', venue:'Bell Sensplex', home:'T4', away:'T2', status:'scheduled' },
      { id:'R10G2', round:10, date:'2026-01-26', time:'11:00 PM – 12:00 AM', venue:'Bell Sensplex', home:'T1', away:'T3', status:'scheduled' },

      { id:'PO-SF1', stage:'Semi Final 1', date:'2026-02-02', time:'10:00 PM – 11:00 PM', venue:'Bell Sensplex', home:'1st Place', away:'2nd Place', status:'scheduled' },
      { id:'PO-QF',  stage:'Quarter Final', date:'2026-02-02', time:'11:00 PM – 12:00 AM', venue:'Bell Sensplex', home:'3rd Place', away:'4th Place', status:'scheduled' },
      { id:'PO-SF2', stage:'Semi Final 2', date:'2026-02-03', time:'TBD (Feb 3–8)', venue:'Bell Sensplex', home:'Loser SF1', away:'Winner QF', status:'scheduled' },
      { id:'PO-F',   stage:'Final',        date:'2026-02-09', time:'10:00 PM – 11:00 PM', venue:'Bell Sensplex', home:'Winner SF1', away:'Winner SF2', status:'scheduled' }
    ],

    // Results (now with GDB scorers + assists and YouTube link slot)
    results: [
      {
        id:'RES-R1G1',
        date:'2025-10-29',
        home:'T3', away:'T2', hs:3, as:4,
        scorers:{
          T3:["Sowad (3) — AST: Tahmid (2)"],
          T2:["Saadman (3), Zarif Jr (1) — AST: Sindeed (2), Ilham (1)"]
        },
        video:"https://youtu.be/0qn56BaI-p8?si=F0ngKFkf4PB02ytS"
      },
      {
        id:'RES-R1G2',
        date:'2025-10-29',
        home:'T1', away:'T5', hs:3, as:2,
        scorers:{
          T1:["Adeeb (2), Monjur (1) — AST: Sadman Kabir (1), Aymaan Alamgir (1)"],
          T5:["Abdu (1), Arif (1) — AST: Egal (1), Abdu (1)"]
        },
        video:"https://youtu.be/YtLpKNUTD28?si=HCsWdfKYolkt14p6"
      }
    ]
  };

  // ========= Utils =========
  const byId = (id) => document.getElementById(id);
  const teamById = (id) => data.teams.find(t=>t.id===id);
  const playersByTeam = (id) => data.players.filter(p=>p.teamId===id);
  const fmtDate = (d) => new Date(d+"T12:00:00").toLocaleDateString(undefined,{year:'numeric',month:'short',day:'numeric'});

  function hexToRgb(hex){ const h = (hex||'').replace('#',''); const bigint = parseInt(h.length===3 ? h.split('').map(x=>x+x).join('') : h, 16); return {r:(bigint>>16)&255, g:(bigint>>8)&255, b:(bigint)&255}; }
  function isLight(hex){ try{ const {r,g,b}=hexToRgb(hex); const l=(0.2126*r+0.7152*g+0.0722*b)/255; return l>0.85; }catch{ return false; } }

  // ========= Apply GW1 stats to players =========
  (function applyGW1(){
    const addGA = (name, key, val, teamId=null) => {
      let p = data.players.find(x=>x.name===name && (!teamId || x.teamId===teamId));
      if(!p){
        const lname = name.toLowerCase();
        p = data.players.find(x=>x.name.toLowerCase()===lname && (!teamId || x.teamId===teamId))
          || data.players.find(x=>x.name.toLowerCase().includes(lname) && (!teamId || x.teamId===teamId));
      }
      if(p){ p[key]=(p[key]||0)+val; }
    };

    // Sagol Er Dol (T2): Saadman x3, Zarif Jr x1; AST: Sindeed x2, Ilham x1
    addGA('Saadman','goals',3,'T2');
    addGA('Zarif Jr','goals',1,'T2');
    addGA('Sindeed','assists',2,'T2');
    addGA('Ilham','assists',1,'T2');

    // Crack (T3): Sowaad x3; AST: Tahmid x2
    addGA('Sowad','goals',3,'T3');
    addGA('Tahmid','assists',2,'T3');

    // Adda (T1): Adeeb x2, Monjur x1; AST: Sadman Kabir x1, Aymaan Alamgir x1
    addGA('Adeeb','goals',2,'T1');
    addGA('Monjur','goals',1,'T1');
    addGA('Sadman Kabir','assists',1,'T1');
    addGA('Aymaan Alamgir','assists',1,'T1');

    // Goal Dile Bhat Free (T5): Abdu x1, Arif x2; AST: Egal x1, Abdu x1
    addGA('Arif','goals',1,'T5');
    addGA('Abdu','goals',1,'T5');
    addGA('Egal','assists',1,'T5');
    addGA('Abdu','assists',1,'T5');
  })();

  // ========= Standings =========
  function computeStandings(){
    const base = Object.fromEntries(data.teams.map(t=>[t.id,{ teamId:t.id, team:t.name, short:t.short, color:t.color, played:0,wins:0,draws:0,losses:0,gf:0,ga:0,gd:0,points:0 }]));
    for(const m of data.matches){
      if(m.status!=='final') continue;
      const home = base[m.homeTeamId]; const away = base[m.awayTeamId];
      if(!home||!away) continue;
      home.played++; away.played++;
      home.gf += m.homeScore; home.ga += m.awayScore;
      away.gf += m.awayScore; away.ga += m.homeScore;
      if(m.homeScore>m.awayScore){ home.wins++; home.points+=3; away.losses++; }
      else if(m.homeScore<m.awayScore){ away.wins++; away.points+=3; home.losses++; }
      else { home.draws++; away.draws++; home.points++; away.points++; }
    }
    for(const t of Object.values(base)) t.gd = t.gf - t.ga;
    return Object.values(base).sort((a,b)=> b.points-a.points || b.gd-a.gd || b.gf-a.gf || a.team.localeCompare(b.team));
  }

  function renderTable(sortBy='points', dir='desc'){
    const tbody = byId('table').querySelector('tbody');
    let rows = computeStandings();
    if(sortBy && sortBy!=='rank'){
      const f = dir==='asc'?1:-1; rows = [...rows].sort((a,b)=> (a[sortBy]===b[sortBy]?0:(a[sortBy]>b[sortBy]?1:-1))*f);
    }
    tbody.innerHTML='';
    rows.forEach((r,i)=>{
      const tr=document.createElement('tr');
      tr.innerHTML = `
        <td>${i+1}</td>
        <td><span class="pill">${r.team}</span></td>
        <td>${r.played}</td><td>${r.wins}</td><td>${r.draws}</td><td>${r.losses}</td>
        <td>${r.gf}</td><td>${r.ga}</td><td>${r.gd}</td><td><strong>${r.points}</strong></td>`;
      tbody.appendChild(tr);
    });
    byId('lastUpdated').textContent = 'Updated ' + new Date().toLocaleString();
  }

  // ========= Leaders (no role shown on Home) =========
  function topPlayers(key, limit=5){ return [...data.players].sort((a,b)=> (b[key]??0)-(a[key]??0) || a.name.localeCompare(b.name)).slice(0,limit); }
  function renderLeaders(){
    const scorers = topPlayers('goals',5);
    const assisters = topPlayers('assists',5);
    byId('maxGoals').textContent   = `Max: ${scorers[0]?.goals ?? 0}`;
    byId('maxAssists').textContent = `Max: ${assisters[0]?.assists ?? 0}`;
    const list = (arr, mountId, key) => {
      const el = byId(mountId); el.innerHTML='';
      arr.forEach((p,idx)=>{
        const t = teamById(p.teamId);
        const row = document.createElement('div'); row.className='row';
        row.innerHTML = `
          <div class="avatar">${p.name.split(' ').map(x=>x[0]).join('').slice(0,2)}</div>
          <div>
            <div><strong>${idx+1}. ${p.name}</strong> <span class="muted">${t?.name || ''}</span></div>
          </div>
          <div class="statValue">${p[key]}<span class="statUnit">${key==='goals'?'G':'A'}</span></div>`;
        el.appendChild(row);
      });
    };
    list(scorers, 'topScorers', 'goals');
    list(assisters, 'topAssisters', 'assists');
  }

  // ========= HOME — LATEST MATCHWEEK RESULTS (with logos) =========
  function latestResultsDay(){
    if(!data.results.length) return null;
    const dates = [...new Set(data.results.map(r=>r.date))].sort((a,b)=> new Date(b)-new Date(a));
    return dates[0] || null;
  }
  function renderHomeResults(){
    const mount = byId('thisWeekResults');
    const day = latestResultsDay();
    mount.innerHTML = '';
    if(!day){ mount.innerHTML = '<div class="muted">No results yet.</div>'; return; }
    const dayResults = data.results.filter(r=> r.date===day);

    const info = document.createElement('div');
    info.className='muted'; info.style.margin='0 0 8px 0';
    info.textContent = new Date(day+"T12:00:00").toLocaleDateString(undefined,{weekday:'short',year:'numeric',month:'short',day:'numeric'});
    mount.appendChild(info);

    dayResults.forEach(r=>{
      const ht = teamById(r.home) || {name:r.home, color:'#2563eb'};
      const at = teamById(r.away) || {name:r.away, color:'#7c3aed'};
      const leftColor = isLight(ht.color) ? '#111111' : ht.color;
      const rightColor = isLight(at.color) ? '#111111' : at.color;
      const leftStyle = `color:${leftColor};${isLight(ht.color)?'border:1px solid #e2e8f0;padding:2px 6px;border-radius:8px':''}`;
      const rightStyle = `color:${rightColor};${isLight(at.color)?'border:1px solid #e2e8f0;padding:2px 6px;border-radius:8px':''}`;
      const row = document.createElement('div'); row.className='matchRow';
      const lsrc = data.logoSrc[r.home] || '';
      const rsrc = data.logoSrc[r.away] || '';
      row.innerHTML = `
        <div class="teamSide"><img class="teamLogo" src="${lsrc}" alt="${ht.name} logo"><span class="teamName" style="${leftStyle}">${ht.name}</span></div>
        <div class="scoreBig">${r.hs}&nbsp;–&nbsp;${r.as}</div>
        <div class="teamSide" style="justify-content:flex-end"><span class="teamName" style="${rightStyle}">${at.name}</span><img class="teamLogo" src="${rsrc}" alt="${at.name} logo"></div>`;
      mount.appendChild(row);
    });
  }

  // ========= Schedule / Rosters / Results =========
  function renderSchedule(){
    const wrap = byId('scheduleWrap'); wrap.innerHTML='';
    const items = [...data.schedule].sort((a,b)=> new Date(a.date)-new Date(b.date));
    byId('gameCount').textContent = `${items.length} games`;
    let currentMonth='';
    items.forEach(g=>{
      const m = new Date(g.date+"T12:00:00").toLocaleString(undefined,{month:'long',year:'numeric'});
      if(m!==currentMonth){ currentMonth=m; const h=document.createElement('h3'); h.textContent=currentMonth; h.style.margin='6px 0 8px'; wrap.appendChild(h); }
      const div=document.createElement('div'); div.className='card'; div.style.marginBottom='10px';
      const ht = teamById(g.home)?.name || g.home; const at = teamById(g.away)?.name || g.away;
      div.innerHTML = `
        <div class="hd"><h2>${ht} vs ${at}</h2><span class="badge">${g.status||'scheduled'}</span></div>
        <div class="bd">${fmtDate(g.date)} — ${g.time||''} · ${g.venue||'Bell Sensplex'}</div>`;
      wrap.appendChild(div);
    });
  }

  function renderRosters(){
    const mount = byId('rosterList'); mount.innerHTML='';
    data.teams.forEach(team=>{
      const players = playersByTeam(team.id);
      const det = document.createElement('details'); det.className='team card';
      det.innerHTML = `
        <summary class="hd" style="cursor:pointer">
          <div style="display:flex;align-items:center;gap:10px"><span class="pill">${team.name}</span></div>
          <span class="muted">${players.length} players</span>
        </summary>
        <div class="bd">
          <table style="width:100%;border-collapse:collapse"><thead><tr><th>Name</th><th>Role</th></tr></thead>
            <tbody>${players.map(p=>`<tr><td>${p.name}</td><td>${p.position||''}</td></tr>`).join('')}</tbody>
          </table>
        </div>`;
      mount.appendChild(det);
    });
    byId('teamCount').textContent = `${data.teams.length} Teams`;
  }

  function youTubeIdFromUrl(url){
    if(!url) return null;
    try{
      const u = new URL(url);
      if(u.hostname.includes('youtu.be')) return u.pathname.slice(1);
      if(u.hostname.includes('youtube.com')) return u.searchParams.get('v');
      return null;
    }catch{ return null; }
  }

  function renderResults(){
    const wrap = byId('resultsList'); wrap.innerHTML='';
    const items = [...data.results].sort((a,b)=> new Date(b.date)-new Date(a.date));
    byId('resultsCount').textContent = `${items.length} games`;
    if(!items.length){ wrap.innerHTML = '<div class="muted">No results yet.</div>'; return; }
    items.forEach(r=>{
      const ht = teamById(r.home)?.name || r.home; const at = teamById(r.away)?.name || r.away;
      const div = document.createElement('div'); div.className='card'; div.id = `results-${r.id}`;
      const ytId = youTubeIdFromUrl(r.video);
      div.innerHTML = `
        <div class="hd">
          <h2>${fmtDate(r.date)} — ${ht} ${r.hs}&nbsp;–&nbsp;${r.as} ${at}</h2>
          <span class="badge">Final</span>
        </div>
        <div class="bd">
          <div style="display:grid;gap:8px">
            <div><strong>${ht}</strong> scorers: <span class="muted">${(r.scorers?.[r.home]||[]).join(', ') || '—'}</span></div>
            <div><strong>${at}</strong> scorers: <span class="muted">${(r.scorers?.[r.away]||[]).join(', ') || '—'}</span></div>
            ${r.video && (ytId ? `
              <div style="margin-top:8px">
                <a class="pill" href="${r.video}" target="_blank" rel="noopener noreferrer">▶ Watch on YouTube</a>
              </div>
              <div class="iframeWrap" style="margin-top:8px">
                <iframe src="https://www.youtube.com/embed/${ytId}" allowfullscreen loading="lazy"></iframe>
              </div>` : `
              <div style="margin-top:8px">
                <a class="pill" href="${r.video}" target="_blank" rel="noopener noreferrer">▶ Watch on YouTube</a>
              </div>`)}
          </div>
        </div>`;
      wrap.appendChild(div);
    });
  }

  // ========= Router =========
  const sections = ['home','schedule','rosters','results','stats'];
  function setRoute(hash){
    const route = (hash||'#home').split('?')[0];
    sections.forEach(id=>{ (document.getElementById(id)||{}).hidden = ('#'+id)!==route; });
    document.querySelectorAll('.tab').forEach(btn=> btn.setAttribute('aria-current', btn.dataset.route===route?'page':'false'));
    if(route==="#home"){ renderHomeResults(); renderTable(); renderLeaders(); }
    if(route==="#schedule"){ renderSchedule(); }
    if(route==="#rosters"){ renderRosters(); }
    if(route==="#results"){ renderResults(); }
    if(route==="#stats"){ byId('statsSheetWrap').innerHTML = data.embeds.statsSheetUrl ? `<iframe src="${data.embeds.statsSheetUrl.replace('/edit','/preview')}" loading="lazy" allowfullscreen></iframe>` : `<div class='muted'>Add <code>data.embeds.statsSheetUrl</code> to show your full stats.</div>`; }
  }
  window.addEventListener('hashchange', ()=> setRoute(location.hash));
  document.querySelectorAll('.tab').forEach(btn=> btn.addEventListener('click', ()=> { location.hash = btn.dataset.route; if(window.innerWidth<=720){ tabs.classList.remove('open'); toggle.setAttribute('aria-expanded','false'); } }));

  // Table sorting
  (function initSort(){
    document.addEventListener('click', (e)=>{
      const table = document.querySelector('#table'); if(!table) return;
      const btn = e.target.closest('#table thead button[data-sort]');
      if(!btn) return; const key = btn.dataset.sort;
      if(!initSort.state) initSort.state = { key:'points', dir:'desc' };
      initSort.state = (initSort.state.key===key) ? { key, dir: initSort.state.dir==='desc'?'asc':'desc' } : { key, dir:'desc' };
      renderTable(initSort.state.key, initSort.state.dir);
    });
  })();

  // Mobile menu toggle
  const toggle = document.getElementById('menuToggle');
  const tabs = document.getElementById('siteTabs');
  toggle.addEventListener('click', ()=>{
    const open = tabs.classList.toggle('open');
    toggle.setAttribute('aria-expanded', open ? 'true' : 'false');
  });

  // Boot
  (function boot(){
    document.getElementById('seasonRange').textContent = `${new Date(data.seasonStart).getFullYear()}/${String(new Date(data.seasonEnd).getFullYear()).slice(-2)}`;
    if(!location.hash) location.hash = '#home';
    setRoute(location.hash);
  })();
</script>
</body>
</html>

